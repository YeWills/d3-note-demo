<html>  
  <head>  
        <meta charset="utf-8">  
        <title>12.3.1 拖拽饼状图</title>  
  <style>


  </style>
  </head> 
  <body>  
		<script src="../../d3/3.x/d3.min.js" charset="utf-8"></script>  
        <script>
		
		var width  = 600;	//SVG绘制区域的宽度
		var height = 600;	//SVG绘制区域的高度
			
		var svg = d3.select("body")			//选择<body>
					.append("svg")			//在<body>中添加<svg>
					.attr("width", width)	//设定<svg>的宽度属性
					.attr("height", height);//设定<svg>的高度属性
		
		//1.确定初始数据
		var dataset = [ ["小米",60.8] , ["三星",58.4] , ["联想",47.3] , ["苹果",46.6] ,
						["华为",41.3] , ["酷派",40.1] , ["其他",111.5] ];
		
		//2.转换数据
		var pie = d3.layout.pie()
					.value(function(d){ return d[1]; });
						
		var piedata = pie(dataset);

		console.log(piedata);
		
		//3.绘制
		
		//字体大小
		var fontsize = 14;
		
		//外半径和内半径
		var outerRadius = 400 / 3;
		var innerRadius = 0;
		
		//创建弧生成器
		var arc = d3.svg.arc()
						.innerRadius(innerRadius)
						.outerRadius(outerRadius);
		
		var color = d3.scale.category20();
		
		//添加对应数目的弧组，即<g>元素
		var arcs = svg.selectAll("g")
					  .data(piedata)		//绑定转换后的数据piedata
					  .enter()
					  .append("g")
					  .each(function(d){
						  //customDx123 这个属性是自己加和命名的
					  	d.customDx123 = width/2;
					  	d.customDy123 = height/2;
					  })
					  .attr("transform","translate("+( width/2 )+","+ ( height/2 ) +")");
		
		//绘制弧
		arcs.append("path")
			.attr("fill",function(d,i){
				return color(i);	//设定弧的颜色
			})
			.attr("d",function(d){
				return arc(d);	//使用弧生成器
			});
		
		//4. 交互式
		var drag = d3.behavior.drag()
			    	.origin(null)
					.on("drag", dragmove);


		function dragmove(d) {
			  //customDx123 这个属性是自己加和命名的
			d.customDx123 += d3.event.dx;
			d.customDy123 += d3.event.dy;
			d3.select(this)
				.attr("transform","translate("+d.customDx123+","+d.customDy123+")");
		}


		arcs.call(drag);

        </script>  
		
    </body>  
</html>  